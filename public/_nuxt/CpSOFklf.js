import{o as l,c as d,a as e,t as s,x as v,I as R,n as _,A as L,j as F,k as V,b as x,m,v as k,p as P,y as S,F as h,r as f,g as p,d as j}from"./D8_npMnH.js";const B={class:"bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg"},I={class:"p-5"},M={class:"flex items-center"},z={class:"flex-shrink-0"},G={class:"h-12 w-12 bg-primary-100 dark:bg-primary-900 rounded-md flex items-center justify-center"},K={class:"text-2xl"},O={class:"ml-5 w-0 flex-1"},q={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},H={class:"mt-1"},J={class:"text-2xl font-semibold text-gray-900 dark:text-white"},Q={key:0,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},w={__name:"StatCard",props:{title:String,value:[String,Number],subtitle:String,icon:String},setup(i){return(u,y)=>(l(),d("div",B,[e("div",I,[e("div",M,[e("div",z,[e("div",G,[e("span",K,s(i.icon||"ðŸ“Š"),1)])]),e("div",O,[e("dl",null,[e("dt",q,s(i.title),1),e("dd",H,[e("div",J,s(i.value),1)]),i.subtitle?(l(),d("dd",Q,s(i.subtitle),1)):v("",!0)])])])])]))}},W={class:"text-center py-12"},X={class:"text-6xl mb-4"},Y={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Z={class:"text-gray-500 dark:text-gray-400 mb-6"},ee={__name:"EmptyState",props:{icon:{type:String,default:"ðŸ“¦"},title:{type:String,default:"No items found"},message:{type:String,default:"Get started by creating a new item"}},setup(i){return(u,y)=>(l(),d("div",W,[e("div",X,s(i.icon),1),e("h3",Y,s(i.title),1),e("p",Z,s(i.message),1),R(u.$slots,"action")]))}},te={__name:"LoadingSpinner",props:{size:{type:String,default:"md"},containerClass:{type:String,default:"py-12"}},setup(i){const u=i,y=L(()=>u.size==="sm"?"h-6 w-6 border-primary-600":u.size==="lg"?"h-16 w-16 border-primary-600":"h-12 w-12 border-primary-600");return(b,g)=>(l(),d("div",{class:_(["flex justify-center items-center",i.containerClass])},[e("div",{class:_(["animate-spin rounded-full border-b-2 border-primary-600",y.value]),'"':""},null,2)],2))}},ae={class:"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8"},re={class:"max-w-7xl mx-auto"},se={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},oe={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8"},le={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},de=["value"],ne=["value"],ie={class:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden"},ue={key:0,class:"p-8 text-center"},ce={key:1,class:"p-8 text-center"},ge={key:2,class:"overflow-x-auto"},ye={class:"w-full"},pe={class:"divide-y divide-gray-200 dark:divide-gray-700"},xe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},me={class:"text-xs text-gray-500 dark:text-gray-400"},ve={class:"px-6 py-4 whitespace-nowrap text-sm"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},ke={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400 max-w-xs truncate"},he={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},we={key:3,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center"},_e={class:"text-sm text-gray-600 dark:text-gray-400"},De={class:"flex gap-2"},Te={class:"px-3 py-1 text-sm text-gray-600 dark:text-gray-400"},$e={__name:"activity-logs",setup(i){const{$api:u}=F(),y=p(!1),b=p([]),g=p(null),n=p(null),D=p([]),T=p([]),r=p({search:"",action:"",resourceType:"",startDate:"",endDate:"",page:1,limit:50}),C=o=>({CREATE:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-100",UPDATE:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-100",DELETE:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-100",LOGIN:"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-100",LOGIN_FAILED:"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-100",BULK_CREATE:"bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-100"})[o]||"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-100",U=o=>new Date(o).toLocaleString(),c=async()=>{y.value=!0;try{const a=`/activity/log?${new URLSearchParams({page:r.value.page,limit:r.value.limit,...r.value.search&&{search:r.value.search},...r.value.action&&{action:r.value.action},...r.value.resourceType&&{resourceType:r.value.resourceType},...r.value.startDate&&{startDate:r.value.startDate},...r.value.endDate&&{endDate:r.value.endDate}})}`,t=await u.get(a);b.value=t.activities||[],n.value=t.pagination}catch(o){console.error("Error details:",o.message,o.response?.data)}finally{y.value=!1}},A=async()=>{try{const a=`/activity/summary?${new URLSearchParams({...r.value.startDate&&{startDate:r.value.startDate},...r.value.endDate&&{endDate:r.value.endDate}})}`,t=await u.get(a);g.value={totalActivities:t.summary.totalActivities,byAction:t.byAction,byResourceType:t.byResourceType,topUsers:t.topUsers}}catch(o){console.error("âŒ Failed to fetch summary:",o)}},N=async()=>{try{const o=await u.get("/activity/types");D.value=o.actions||[],T.value=o.resourceTypes||[]}catch(o){console.error("âŒ Failed to fetch activity types:",o)}},E=()=>{r.value={search:"",action:"",resourceType:"",startDate:"",endDate:"",page:1,limit:50},c(),A()},$=o=>{r.value.page=o,c()};return V(()=>{c(),A(),N()}),(o,a)=>(l(),d("main",ae,[e("div",re,[a[15]||(a[15]=e("div",{class:"mb-8"},[e("h1",{class:"text-4xl font-bold text-gray-900 dark:text-white"},"Activity Monitor"),e("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Track all system changes and user activities ")],-1)),g.value?(l(),d("div",se,[x(w,{title:"Total Activities",value:g.value.totalActivities,icon:"ðŸ“Š"},null,8,["value"]),x(w,{title:"Top User Activity",value:g.value.topUsers[0]?.count||0,subtitle:g.value.topUsers[0]?.user?.firstName+" "+g.value.topUsers[0]?.user?.lastName,icon:"ðŸ‘¤"},null,8,["value","subtitle"]),x(w,{title:"Resource Types",value:g.value.byResourceType.length,icon:"ðŸ“¦"},null,8,["value"])])):v("",!0),e("div",oe,[e("div",le,[e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Search Description ",-1)),m(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>r.value.search=t),type:"text",placeholder:"Search...",class:"w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white",onKeyup:P(c,["enter"])},null,544),[[k,r.value.search]])]),e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Action ",-1)),m(e("select",{"onUpdate:modelValue":a[1]||(a[1]=t=>r.value.action=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:c},[a[8]||(a[8]=e("option",{value:""},"All Actions",-1)),(l(!0),d(h,null,f(D.value,t=>(l(),d("option",{key:t,value:t},s(t),9,de))),128))],544),[[S,r.value.action]])]),e("div",null,[a[11]||(a[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Resource Type ",-1)),m(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>r.value.resourceType=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:c},[a[10]||(a[10]=e("option",{value:""},"All Types",-1)),(l(!0),d(h,null,f(T.value,t=>(l(),d("option",{key:t,value:t},s(t),9,ne))),128))],544),[[S,r.value.resourceType]])]),e("div",null,[a[12]||(a[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," From Date ",-1)),m(e("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>r.value.startDate=t),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:c},null,544),[[k,r.value.startDate]])]),e("div",null,[a[13]||(a[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," To Date ",-1)),m(e("input",{"onUpdate:modelValue":a[4]||(a[4]=t=>r.value.endDate=t),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white",onChange:c},null,544),[[k,r.value.endDate]])])]),e("div",{class:"mt-4 flex gap-2"},[e("button",{onClick:c,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"}," Apply Filters "),e("button",{onClick:E,class:"px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-900 dark:text-white rounded-md hover:bg-gray-400 transition"}," Clear Filters ")])]),e("div",ie,[y.value?(l(),d("div",ue,[x(te)])):b.value.length===0?(l(),d("div",ce,[x(ee,{title:"No activities found",message:"Try adjusting your filters or check back later"})])):(l(),d("div",ge,[e("table",ye,[a[14]||(a[14]=e("thead",{class:"bg-gray-100 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," User "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Action "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Resource "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Description "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," IP Address "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Date/Time ")])],-1)),e("tbody",pe,[(l(!0),d(h,null,f(b.value,t=>(l(),d("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700 transition"},[e("td",xe,[j(s(t.user.firstName)+" "+s(t.user.lastName)+" ",1),e("div",me," @"+s(t.user.username),1)]),e("td",ve,[e("span",{class:_([C(t.action),"px-3 py-1 rounded-full text-xs font-medium"])},s(t.action),3)]),e("td",be,s(t.resourceType),1),e("td",ke,s(t.description),1),e("td",he,s(t.ipAddress||"-"),1),e("td",fe,s(U(t.createdAt)),1)]))),128))])])])),n.value&&n.value.pages>1?(l(),d("div",we,[e("div",_e," Showing "+s((n.value.page-1)*n.value.limit+1)+" to "+s(Math.min(n.value.page*n.value.limit,n.value.total))+" of "+s(n.value.total)+" activities ",1),e("div",De,[n.value.page>1?(l(),d("button",{key:0,onClick:a[5]||(a[5]=t=>$(n.value.page-1)),class:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm hover:bg-gray-50 dark:hover:bg-gray-700"}," Previous ")):v("",!0),e("span",Te," Page "+s(n.value.page)+" of "+s(n.value.pages),1),n.value.page<n.value.pages?(l(),d("button",{key:1,onClick:a[6]||(a[6]=t=>$(n.value.page+1)),class:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm hover:bg-gray-50 dark:hover:bg-gray-700"}," Next ")):v("",!0)])])):v("",!0)])])]))}};export{$e as default};
