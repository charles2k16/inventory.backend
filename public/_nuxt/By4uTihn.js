import{_ as V}from"./jNmtiVgl.js";import{H as F,g,k as R,c as d,a as e,b as A,w as M,q as $,d as x,m as i,v as c,l as r,x as p,y as H,F as N,r as C,t as l,j as k,o as n,A as _}from"./D8_npMnH.js";const L={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},B={class:"bg-white dark:bg-gray-800 shadow"},E={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},G={class:"flex justify-between items-center"},j={class:"max-w-4xl mx-auto py-6 sm:px-6 lg:px-8"},z={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6 mb-8"},Y={class:"flex gap-2"},O=["value"],Q={key:1,class:"mt-2 p-3 bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-md"},W={class:"text-sm font-medium text-green-800 dark:text-green-200"},J={class:"text-sm text-green-700 dark:text-green-300 mt-1"},K={key:2,class:"mt-2 p-3 bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-md text-sm text-yellow-800 dark:text-yellow-200"},X={key:0,class:"p-4 bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg"},Z={class:"text-sm text-blue-700 dark:text-blue-200"},tt={class:"font-semibold text-lg text-blue-900 dark:text-blue-100"},et={key:1,class:"p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded-lg"},rt=["disabled"],at={key:0,class:"animate-spin"},ot={key:0,class:"bg-white dark:bg-gray-800 shadow rounded-lg"},st={class:"overflow-x-auto"},dt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},lt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},nt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300"},ut={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300"},ct={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900 dark:text-white"},pt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300"},yt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300"},mt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},gt=["onClick"],xt={key:1,class:"bg-white dark:bg-gray-800 shadow rounded-lg p-8 text-center"},ft={__name:"stock-records",setup(bt){F();const a=g({productId:"",productSearch:"",quantity:null,costPerUnit:null,supplier:"",invoiceNumber:"",purchaseDate:new Date().toISOString().split("T")[0],notes:""}),w=g([]),f=g([]),y=g(!1),u=g(""),b=_(()=>w.value.find(s=>s.id===a.value.productId)||null),h=_(()=>{const s=a.value.productSearch.toLowerCase();return w.value.filter(t=>t.itemName.toLowerCase().includes(s)||t.barcodeNumber&&t.barcodeNumber.toLowerCase().includes(s))}),v=s=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),P=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),S=async()=>{try{const{$api:s}=k(),t=await s.get("/products",{limit:1e3});w.value=t.products||[]}catch(s){u.value="Failed to load products",console.error(s)}},D=async()=>{try{const{$api:s}=k(),t=new Date,m=q(t),o=t.getFullYear(),U=await s.get("/stock-reports/additional-stock",{weekNumber:m,year:o});f.value=U.additionalStock||[]}catch(s){console.error("Failed to load recent records:",s)}},q=s=>{const t=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())),m=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-m);const o=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t-o)/864e5+1)/7)},I=async()=>{try{u.value="",y.value=!0;const{$api:s}=k();if(!a.value.productId||!a.value.quantity||!a.value.costPerUnit){u.value="Please fill in all required fields";return}await s.post("/stock-reports/additional-stock/record",{productId:a.value.productId,quantity:a.value.quantity,costPerUnit:a.value.costPerUnit,supplier:a.value.supplier||null,invoiceNumber:a.value.invoiceNumber||null,purchaseDate:a.value.purchaseDate,notes:a.value.notes||null}),a.value={productId:"",productSearch:"",quantity:null,costPerUnit:null,supplier:"",invoiceNumber:"",purchaseDate:new Date().toISOString().split("T")[0],notes:""},await D(),await S()}catch(s){u.value=s.message||"Error recording stock"}finally{y.value=!1}},T=async s=>{if(confirm("Are you sure you want to delete this stock record?"))try{const{$api:t}=k();await t.delete(`/stock-reports/additional-stock/${s}`),await D(),await S()}catch(t){u.value="Error deleting record",console.error(t)}};return R(()=>{S(),D()}),(s,t)=>{const m=V;return n(),d("div",L,[e("header",B,[e("div",E,[e("div",G,[t[10]||(t[10]=e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," Record Additional Stock ",-1)),A(m,{to:"/stock-reports",class:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},{default:M(()=>[...t[9]||(t[9]=[x(" ← Back to Reports ",-1)])]),_:1})])])]),e("main",j,[e("div",z,[t[22]||(t[22]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-6"}," New Stock Purchase ",-1)),e("form",{onSubmit:$(I,["prevent"]),class:"space-y-6"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[x(" Product "),e("span",{class:"text-red-600"},"*")],-1)),e("div",Y,[i(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>r(a).productSearch=o),type:"text",placeholder:"Search products...",class:"flex-1 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border"},null,512),[[c,r(a).productSearch]]),r(a).productSearch?(n(),d("button",{key:0,onClick:t[1]||(t[1]=o=>r(a).productSearch=""),class:"px-3 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white font-medium"}," ✕ ")):p("",!0)]),r(h).length>0&&r(a).productSearch?i((n(),d("select",{key:0,"onUpdate:modelValue":t[2]||(t[2]=o=>r(a).productId=o),size:"5",class:"mt-2 w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border"},[t[11]||(t[11]=e("option",{value:""},"Choose a product...",-1)),(n(!0),d(N,null,C(r(h),o=>(n(),d("option",{key:o.id,value:o.id},l(o.itemName)+" - Current Stock: "+l(o.currentStock),9,O))),128))],512)),[[H,r(a).productId]]):p("",!0),r(b)?(n(),d("div",Q,[e("p",W," ✓ Selected: "+l(r(b).itemName),1),e("p",J," Category: "+l(r(b).category)+" | Current Stock: "+l(r(b).currentStock),1)])):p("",!0),r(a).productSearch&&r(h).length===0?(n(),d("div",K," No products found. Try a different search. ")):p("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[x(" Quantity "),e("span",{class:"text-red-600"},"*")],-1)),i(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r(a).quantity=o),type:"number",min:"1",class:"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border",placeholder:"Enter quantity"},null,512),[[c,r(a).quantity,void 0,{number:!0}]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[x(" Cost Per Unit (GHS) "),e("span",{class:"text-red-600"},"*")],-1)),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>r(a).costPerUnit=o),type:"number",step:"0.01",min:"0",class:"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border",placeholder:"Enter cost per unit"},null,512),[[c,r(a).costPerUnit,void 0,{number:!0}]])]),r(a).quantity&&r(a).costPerUnit?(n(),d("div",X,[e("p",Z,[t[15]||(t[15]=e("span",{class:"font-medium"},"Total Cost:",-1)),e("span",tt," GHS "+l(v(r(a).quantity*r(a).costPerUnit)),1)])])):p("",!0),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Supplier ",-1)),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>r(a).supplier=o),type:"text",class:"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border",placeholder:"Supplier name (optional)"},null,512),[[c,r(a).supplier]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Invoice Number ",-1)),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>r(a).invoiceNumber=o),type:"text",class:"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border",placeholder:"Invoice number (optional)"},null,512),[[c,r(a).invoiceNumber]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Purchase Date ",-1)),i(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>r(a).purchaseDate=o),type:"date",class:"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border"},null,512),[[c,r(a).purchaseDate]]),t[19]||(t[19]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Defaults to today if not specified ",-1))]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Notes ",-1)),i(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=o=>r(a).notes=o),class:"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:bg-gray-700 dark:text-white px-3 py-2 border",rows:"3",placeholder:"Additional notes (optional)"},null,512),[[c,r(a).notes]])]),r(u)?(n(),d("div",et,l(r(u)),1)):p("",!0),e("button",{type:"submit",disabled:r(y)||!r(a).productId||!r(a).quantity||!r(a).costPerUnit,class:"w-full px-4 py-3 bg-primary-600 dark:bg-primary-700 text-white rounded-lg hover:bg-primary-700 dark:hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed font-semibold flex items-center justify-center gap-2"},[r(y)?(n(),d("span",at,[...t[21]||(t[21]=[e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):p("",!0),x(" "+l(r(y)?"Recording...":"Record Stock Purchase"),1)],8,rt)],32)]),r(f).length>0?(n(),d("div",ot,[t[24]||(t[24]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"}," Recent Stock Records (This Week) ")],-1)),e("div",st,[e("table",dt,[t[23]||(t[23]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Product "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Quantity "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Cost/Unit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Total Cost "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Supplier "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Action ")])],-1)),e("tbody",lt,[(n(!0),d(N,null,C(r(f),o=>(n(),d("tr",{key:o.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",nt,l(o.product.itemName),1),e("td",it,l(o.quantity),1),e("td",ut," GHS "+l(v(o.costPerUnit)),1),e("td",ct," GHS "+l(v(o.totalCost)),1),e("td",pt,l(o.supplier||"-"),1),e("td",yt,l(P(o.purchaseDate)),1),e("td",mt,[e("button",{onClick:U=>T(o.id),class:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300"}," Delete ",8,gt)])]))),128))])])])])):(n(),d("div",xt,[...t[25]||(t[25]=[e("p",{class:"text-gray-600 dark:text-gray-400"}," No stock records added this week yet. ",-1)])]))])])}}};export{ft as default};
