import{_ as M}from"./jNmtiVgl.js";import{_ as A}from"./DfpBFmAH.js";import{u as B}from"./aWCr3NSR.js";import{J as D,k as $,c as i,a as t,t as a,l as s,x as n,b as N,w as P,n as p,F as E,r as L,j as S,g as x,o as l,d as F}from"./D8_npMnH.js";const I={class:"bg-white dark:bg-gray-800 shadow"},q={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},J={class:"flex justify-between items-center"},R={class:"text-3xl font-bold text-gray-900 dark:text-white"},V={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},O={class:"flex gap-3"},j={key:0,class:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8 flex justify-center"},G={key:1,class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},H={class:"bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg p-4"},Q={class:"text-red-800 dark:text-red-200"},z={key:2,class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},K={class:"border-b border-gray-200 dark:border-gray-700 mb-6"},W={class:"flex space-x-8"},X={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Y={class:"md:col-span-2 bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Z={class:"grid grid-cols-2 gap-6"},tt={class:"mt-1 text-gray-900 dark:text-white font-medium"},et={class:"mt-1 text-gray-900 dark:text-white"},st={class:"mt-1 text-gray-900 dark:text-white"},rt={class:"mt-1 text-gray-900 dark:text-white"},at={class:"col-span-2"},ot={class:"mt-1 text-gray-900 dark:text-white"},dt={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},it={class:"space-y-4"},lt={class:"pt-4 border-t border-gray-200 dark:border-gray-700"},nt={class:"mt-1 text-gray-900 dark:text-white"},xt={class:"mt-1 text-gray-900 dark:text-white"},ct={class:"mt-1 text-gray-900 dark:text-gray-300"},gt={class:"pt-4 border-t border-gray-200"},yt={class:"mt-1 text-lg font-semibold text-gray-900 dark:text-gray-300"},pt={class:"md:col-span-3 bg-white shadow rounded-lg p-6"},mt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ut={class:"mt-1 text-gray-900"},kt={class:"mt-1 text-gray-900"},bt={class:"mt-1 text-gray-900"},ft={class:"mt-1 text-gray-900 text-sm"},ht={key:1,class:"bg-white shadow rounded-lg"},_t={class:"p-6"},vt={key:0,class:"text-center py-12"},wt={key:1,class:"overflow-x-auto"},Nt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},St={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Tt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Ut={class:"px-6 py-4 whitespace-nowrap"},Ct={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},Mt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},At={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},Bt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Dt={class:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},$t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},qt={__name:"[id]",setup(Pt){const{canManageStock:T}=B(),_=D(),r=x(null),y=x(!0),c=x(""),g=x("details"),m=x(!1),u=x(!1),k=x(""),b=d=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(d||0),v=d=>{const e=new Date(d);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)},U=d=>({IN:"bg-green-100 text-green-800",OUT:"bg-red-100 text-red-800",ADJUSTMENT:"bg-yellow-100 text-yellow-800",RETURN:"bg-blue-100 text-blue-800"})[d]||"bg-gray-100 text-gray-800",w=async()=>{try{y.value=!0,c.value="";const{$api:d}=S(),e=await d.get(`/products/${_.params.id}`);r.value=e}catch(d){c.value=d.message||"Error loading product details",console.error("Error:",d)}finally{y.value=!1}},C=async d=>{try{u.value=!0,k.value="";const{$api:e}=S(),f=d.action==="add"?"IN":"OUT",h=d.quantity;await e.patch(`/products/${_.params.id}/update-stock`,{type:f,quantity:h,reason:d.reason||"ADJUSTMENT",notes:d.notes}),m.value=!1,await w()}catch(e){k.value=e.message||"Failed to update stock"}finally{u.value=!1}};return $(()=>{w()}),(d,e)=>{const f=M,h=A;return l(),i("div",null,[t("header",I,[t("div",q,[t("div",J,[t("div",null,[t("h1",R,a(s(r)?.itemName||"Loading..."),1),s(r)?.barcodeNumber?(l(),i("p",V," Barcode: "+a(s(r).barcodeNumber),1)):n("",!0)]),t("div",O,[!s(y)&&!s(c)&&s(r)&&s(T)?(l(),i("button",{key:0,onClick:e[0]||(e[0]=o=>m.value=!0),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700"}," ðŸ“¦ Update Stock ")):n("",!0),N(f,{to:"/products",class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:P(()=>[...e[4]||(e[4]=[F(" â† Back to Products ",-1)])]),_:1})])])])]),s(y)?(l(),i("div",j,[...e[5]||(e[5]=[t("div",{class:"flex flex-col items-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mb-4"}),t("p",{class:"text-gray-700 dark:text-gray-300"},"Loading product details...")],-1)])])):n("",!0),s(c)?(l(),i("div",G,[t("div",H,[t("p",Q,a(s(c)),1)])])):n("",!0),!s(y)&&!s(c)&&s(r)?(l(),i("main",z,[t("div",K,[t("div",W,[t("button",{onClick:e[1]||(e[1]=o=>g.value="details"),class:p(["py-2 px-1 border-b-2 font-medium text-sm",s(g)==="details"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"])}," Details ",2),t("button",{onClick:e[2]||(e[2]=o=>g.value="transactions"),class:p(["py-2 px-1 border-b-2 font-medium text-sm",s(g)==="transactions"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Transactions ",2)])]),s(g)==="details"?(l(),i("div",X,[t("div",Y,[e[11]||(e[11]=t("h2",{class:"text-lg font-medium text-gray-900 dark:text-white mb-6"}," Product Information ",-1)),t("div",Z,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Product Name",-1)),t("p",tt,a(s(r).itemName),1)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Category",-1)),t("p",et,a(s(r).category),1)]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Barcode Number",-1)),t("p",st,a(s(r).barcodeNumber||"N/A"),1)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Product Number",-1)),t("p",rt,"#"+a(s(r).itemNumber),1)]),t("div",at,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Description",-1)),t("p",ot,a(s(r).itemDescription||"No description"),1)])])]),t("div",dt,[e[17]||(e[17]=t("h2",{class:"text-lg font-medium text-gray-900 dark:text-white mb-6"}," Stock Information ",-1)),t("div",it,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Current Stock",-1)),t("p",{class:p(["mt-1 text-2xl font-bold",s(r).currentStock<=s(r).reorderLevel?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"])},a(s(r).currentStock)+" "+a(s(r).units),3)]),t("div",lt,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Reorder Level",-1)),t("p",nt,a(s(r).reorderLevel),1)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Selling Price",-1)),t("p",xt," GHS "+a(b(s(r).sellingPrice)),1)]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Cost Price",-1)),t("p",ct," GHS "+a(b(s(r).costPrice)),1)]),t("div",gt,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Stock Value",-1)),t("p",yt," GHS "+a(b(s(r).currentStock*s(r).sellingPrice)),1)])])]),t("div",pt,[e[22]||(e[22]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Additional Information",-1)),t("div",mt,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700"},"Location",-1)),t("p",ut,a(s(r).locationName),1)]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700"},"Units",-1)),t("p",kt,a(s(r).units),1)]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Type",-1)),t("p",bt,a(s(r).type),1)]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700"},"Created",-1)),t("p",ft,a(v(s(r).createdAt)),1)])])])])):n("",!0),s(g)==="transactions"?(l(),i("div",ht,[t("div",_t,[e[25]||(e[25]=t("h2",{class:"text-lg font-medium text-gray-900 mb-6"},"Stock Movements",-1)),!s(r).stockMovements||s(r).stockMovements.length===0?(l(),i("div",vt,[...e[23]||(e[23]=[t("p",{class:"text-gray-500 dark:text-gray-400"}," No stock movements recorded yet ",-1)])])):(l(),i("div",wt,[t("table",Nt,[e[24]||(e[24]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Date "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Type "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Qty Before "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Change "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Qty After "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Reason "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Notes "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Created By ")])],-1)),t("tbody",St,[(l(!0),i(E,null,L(s(r).stockMovements,o=>(l(),i("tr",{key:o.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Tt,a(v(o.createdAt)),1),t("td",Ut,[t("span",{class:p(["px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full",U(o.type)])},a(o.type),3)]),t("td",Ct,a(o.quantityBefore),1),t("td",Mt,[t("span",{class:p(o.type==="OUT"||o.type==="ADJUSTMENT"?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400")},a(o.type==="OUT"||o.type==="ADJUSTMENT"?"-":"+")+a(o.quantity),3)]),t("td",At,a(o.quantityAfter),1),t("td",Bt,a(o.reason||"-"),1),t("td",Dt,a(o.notes||"-"),1),t("td",$t,a(o.createdByUser?`${o.createdByUser.firstName} ${o.createdByUser.lastName}`:"-"),1)]))),128))])])]))])])):n("",!0),N(h,{"is-open":s(m),product:s(r),"is-loading":s(u),error:s(k),onClose:e[3]||(e[3]=o=>m.value=!1),onSubmit:C},null,8,["is-open","product","is-loading","error"])])):n("",!0)])}}};export{qt as default};
