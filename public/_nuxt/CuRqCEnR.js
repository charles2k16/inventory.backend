import{k as j,c as l,a as t,t as o,l as r,F as w,r as _,x as c,m as x,v as p,d as U,j as C,g as m,o as n,n as N}from"./D8_npMnH.js";const $={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},P={class:"bg-red-50 dark:bg-red-900 border-l-4 border-red-400 dark:border-red-600 p-4 mb-6"},z={class:"flex"},B={class:"flex-1"},I={class:"text-2xl font-bold text-red-900 dark:text-red-100 mt-1"},q={class:"bg-white dark:bg-gray-800 shadow sm:rounded-lg"},H={class:"px-4 py-5 sm:p-6"},O={key:0,class:"overflow-x-auto"},G={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},J={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},K={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},Q={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},R={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},W={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},X={class:"px-6 py-4 whitespace-nowrap"},Y={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},Z=["onClick"],tt=["onClick"],et={key:1,class:"text-gray-500 dark:text-gray-400 text-center py-12"},st={key:0,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4"},rt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-md w-full max-h-screen flex flex-col"},at={class:"px-6 py-4 border-b border-gray-200"},ot={class:"text-lg font-medium text-gray-900"},dt={class:"px-6 py-4 overflow-y-auto flex-1"},lt={key:0,class:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-200 rounded"},nt={class:"space-y-4"},it={class:"px-6 py-4 border-t border-gray-200 flex gap-3 justify-end"},mt=["disabled"],ut={key:0,class:"animate-spin"},ct={key:1,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4"},xt={class:"bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-96 flex flex-col"},pt={class:"px-6 py-4 border-b border-gray-200"},yt={class:"text-lg font-medium text-gray-900"},gt={class:"px-6 py-4 overflow-y-auto flex-1"},bt={key:0,class:"mb-6"},ft={class:"space-y-2"},ht={class:"flex justify-between items-start"},vt={class:"font-medium text-gray-900"},kt={class:"text-sm text-gray-600"},wt={class:"text-right"},_t={class:"font-semibold text-gray-900"},Ct={key:1},Nt={class:"space-y-2"},Dt={class:"flex justify-between items-start"},Lt={class:"font-medium text-gray-900"},Mt={class:"text-sm text-gray-600"},Vt={class:"font-semibold text-green-600"},Et={key:2,class:"text-center text-gray-500 py-8"},Ft={__name:"lenders",setup(Tt){const f=m([]),D=m(0),h=m(!1),v=m(!1),y=m(null),i=m(null),g=m(!1),u=m(""),d=m({name:"",phone:"",email:"",address:"",creditLimit:0,notes:""}),b=a=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a||0),L=()=>{d.value={name:"",phone:"",email:"",address:"",creditLimit:0,notes:""},y.value=null},E=()=>{L(),u.value="",h.value=!0},T=a=>{y.value=a,d.value={name:a.name,phone:a.phone||"",email:a.email||"",address:a.address||"",creditLimit:a.creditLimit||0,notes:a.notes||""},u.value="",h.value=!0},M=()=>{h.value=!1,L()},A=async a=>{try{const{$api:e}=C(),s=await e.get(`/lenders/${a.id}`);i.value=s,v.value=!0}catch(e){console.error("Error fetching transactions:",e)}},F=()=>{v.value=!1,i.value=null},S=async()=>{try{u.value="";const{$api:a}=C();if(!d.value.name.trim()){u.value="Customer name is required";return}g.value=!0,y.value?await a.put(`/lenders/${y.value.id}`,d.value):await a.post("/lenders",d.value),await V(),M()}catch(a){u.value=a.message||"Error saving customer"}finally{g.value=!1}},V=async()=>{try{const{$api:a}=C(),e=await a.get("/lenders",{limit:1e3});f.value=e.lenders||[],D.value=f.value.reduce((s,k)=>s+parseFloat(k.currentDebt||0),0)}catch(a){console.error("Error fetching lenders:",a)}};return j(()=>{V()}),(a,e)=>(n(),l("div",null,[t("header",{class:"bg-white dark:bg-gray-800 shadow"},[t("div",{class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex justify-between items-center"},[e[6]||(e[6]=t("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," Credit Customers (Lenders) ",-1)),t("button",{onClick:E,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700"}," + Add Customer ")])]),t("main",$,[t("div",P,[t("div",z,[t("div",B,[e[7]||(e[7]=t("p",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Total Outstanding Debt ",-1)),t("p",I,o(b(r(D))),1)])])]),t("div",q,[t("div",H,[e[9]||(e[9]=t("h3",{class:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4"}," Customers ",-1)),r(f).length>0?(n(),l("div",O,[t("table",G,[e[8]||(e[8]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Name "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Code "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Phone "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Current Debt "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Total Purchased "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Status "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",J,[(n(!0),l(w,null,_(r(f),s=>(n(),l("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",K,o(s.name),1),t("td",Q,o(s.customerCode),1),t("td",R,o(s.phone||"-"),1),t("td",{class:N(["px-6 py-4 whitespace-nowrap text-sm font-semibold",s.currentDebt>0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"])},o(b(s.currentDebt)),3),t("td",W,o(b(s.totalPurchased)),1),t("td",X,[t("span",{class:N(["px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full",s.status==="ACTIVE"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},o(s.status),3)]),t("td",Y,[t("button",{onClick:k=>T(s),class:"text-primary-600 hover:text-primary-900"}," Edit ",8,Z),t("button",{onClick:k=>A(s),class:"text-blue-600 hover:text-blue-900"}," Transactions ",8,tt)])]))),128))])])])):(n(),l("p",et," No credit customers yet. "))])])]),r(h)?(n(),l("div",st,[t("div",rt,[t("div",at,[t("h3",ot,o(r(y)?"Edit Customer":"Create New Customer"),1)]),t("div",dt,[r(u)?(n(),l("div",lt,o(r(u)),1)):c("",!0),t("div",nt,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r(d).name=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 px-3 py-2 border",required:""},null,512),[[p,r(d).name]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Phone",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r(d).phone=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 px-3 py-2 border"},null,512),[[p,r(d).phone]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(d).email=s),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 px-3 py-2 border"},null,512),[[p,r(d).email]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"},"Address",-1)),x(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(d).address=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 px-3 py-2 border"},null,512),[[p,r(d).address]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700"},"Credit Limit",-1)),x(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(d).creditLimit=s),type:"number",step:"0.01",min:"0",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 px-3 py-2 border"},null,512),[[p,r(d).creditLimit,void 0,{number:!0}]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),x(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>r(d).notes=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 px-3 py-2 border",rows:"3"},null,512),[[p,r(d).notes]])])])]),t("div",it,[t("button",{onClick:M,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Cancel "),t("button",{onClick:S,disabled:r(g),class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[r(g)?(n(),l("span",ut,[...e[16]||(e[16]=[t("svg",{class:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):c("",!0),U(" "+o(r(g)?"Saving...":"Save"),1)],8,mt)])])])):c("",!0),r(v)?(n(),l("div",ct,[t("div",xt,[t("div",pt,[t("h3",yt,o(r(i)?.name)+" - Transactions ",1)]),t("div",gt,[r(i)?.sales&&r(i).sales.length>0?(n(),l("div",bt,[e[17]||(e[17]=t("h4",{class:"font-semibold text-gray-900 mb-3"},"Sales",-1)),t("div",ft,[(n(!0),l(w,null,_(r(i).sales,s=>(n(),l("div",{key:s.id,class:"p-3 bg-gray-50 rounded border border-gray-200"},[t("div",ht,[t("div",null,[t("p",vt,o(s.product.itemName),1),t("p",kt,o(s.saleNumber),1)]),t("div",wt,[t("p",_t,o(b(s.totalAmount)),1),t("p",{class:N(["text-sm",s.paymentStatus==="PAID"?"text-green-600":"text-red-600"])},o(s.paymentStatus),3)])])]))),128))])])):c("",!0),r(i)?.payments&&r(i).payments.length>0?(n(),l("div",Ct,[e[18]||(e[18]=t("h4",{class:"font-semibold text-gray-900 mb-3"},"Payments",-1)),t("div",Nt,[(n(!0),l(w,null,_(r(i).payments,s=>(n(),l("div",{key:s.id,class:"p-3 bg-gray-50 rounded border border-gray-200"},[t("div",Dt,[t("div",null,[t("p",Lt,o(s.paymentNumber),1),t("p",Mt,o(s.paymentMethod),1)]),t("p",Vt,o(b(s.amount)),1)])]))),128))])])):c("",!0),(!r(i)?.sales||r(i).sales.length===0)&&(!r(i)?.payments||r(i).payments.length===0)?(n(),l("div",Et," No transactions found ")):c("",!0)]),t("div",{class:"px-6 py-4 border-t border-gray-200"},[t("button",{onClick:F,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Close ")])])])):c("",!0)]))}};export{Ft as default};
