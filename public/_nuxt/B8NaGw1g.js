import{_ as O}from"./jNmtiVgl.js";import{o as p,c as y,a as t,F as et,r as rt,t as x,n as ot,x as h,G as j,m as v,v as f,l as o,d as N,b as w,w as z,g as u,j as at,k as st,z as dt,s as q,C as it,A as C}from"./D8_npMnH.js";import{_ as nt}from"./2HMNWRjp.js";import{_ as lt}from"./DfpBFmAH.js";import{u as ut}from"./aWCr3NSR.js";const ct={class:"mb-6 bg-white dark:bg-gray-800 p-4 rounded-lg shadow"},mt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},gt=["value"],pt=["value"],yt={class:"flex items-center"},xt=["checked"],bt={__name:"ProductFilters",props:{search:{type:String,default:""},category:{type:String,default:""},lowStock:{type:Boolean,default:!1}},emits:["update:search","update:category","update:lowStock"],setup(i){return(m,a)=>(p(),y("div",ct,[t("div",mt,[t("input",{value:i.search,onInput:a[0]||(a[0]=c=>m.$emit("update:search",c.target.value)),type:"text",placeholder:"Search products...",class:"px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-primary-500 focus:border-primary-500"},null,40,gt),t("select",{value:i.category,onInput:a[1]||(a[1]=c=>m.$emit("update:category",c.target.value)),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-primary-500 focus:border-primary-500"},[...a[3]||(a[3]=[t("option",{value:""},"All Categories",-1),t("option",{value:"Equipment"},"Equipment",-1),t("option",{value:"Tools"},"Tools",-1)])],40,pt),t("div",yt,[t("input",{id:"low-stock",checked:i.lowStock,onChange:a[2]||(a[2]=c=>m.$emit("update:lowStock",c.target.checked)),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,40,xt),a[4]||(a[4]=t("label",{for:"low-stock",class:"ml-2 block text-sm text-gray-900 dark:text-gray-300"}," Low Stock Only ",-1))])])]))}},kt={class:"bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg"},vt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ft={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},wt={class:"px-6 py-4 whitespace-nowrap"},ht={class:"text-sm font-medium text-gray-900 dark:text-white"},St={class:"text-sm text-gray-500 dark:text-gray-400"},$t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Pt={class:"px-6 py-4 whitespace-nowrap"},_t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white font-medium"},Nt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},Lt=["onClick"],Mt=["onClick"],Et=["onClick"],Ut={__name:"ProductsTable",props:{products:{type:Array,default:()=>[]},showManageActions:{type:Boolean,default:!0}},emits:["edit","stock","view"],setup(i){const m=a=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a||0);return(a,c)=>(p(),y("div",kt,[t("table",vt,[c[0]||(c[0]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Product "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Category "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Stock "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Price "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Value "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",ft,[(p(!0),y(et,null,rt(i.products,r=>(p(),y("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",wt,[t("div",ht,x(r.itemName),1),t("div",St,x(r.barcodeNumber),1)]),t("td",$t,x(r.category),1),t("td",Pt,[t("span",{class:ot(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",r.currentStock<=r.reorderLevel?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"])},x(r.currentStock),3)]),t("td",_t," GHS "+x(m(r.sellingPrice)),1),t("td",Ct," GHS "+x(m(r.currentStock*r.sellingPrice)),1),t("td",Nt,[i.showManageActions?(p(),y("button",{key:0,onClick:g=>a.$emit("edit",r),class:"text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-300"}," Edit ",8,Lt)):h("",!0),i.showManageActions?(p(),y("button",{key:1,onClick:g=>a.$emit("stock",r),class:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300"}," Stock ",8,Mt)):h("",!0),t("button",{onClick:g=>a.$emit("view",r),class:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"}," View ",8,Et)])]))),128))])])]))}},At={key:0,class:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center z-50 p-4"},Tt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-md w-full max-h-screen flex flex-col"},Bt={class:"px-6 py-4 overflow-y-auto flex-1"},qt={key:0,class:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-200 rounded"},Dt={class:"space-y-4"},Vt={class:"grid grid-cols-2 gap-4"},Ft={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md border border-gray-200 dark:border-gray-600"},It={class:"text-sm font-medium text-gray-900 dark:text-white mb-2"},Ot={class:"text-primary-600 dark:text-primary-400"},jt={class:"text-xs text-gray-600 dark:text-gray-300 mb-3"},zt={class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end"},Qt=["disabled"],Gt={key:0,class:"animate-spin"},Ht={__name:"EditProductModal",props:{isOpen:{type:Boolean,default:!1},product:{type:Object,default:null},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["close","submit"],setup(i,{emit:m}){const a=i,c=m,r=u({itemName:"",itemDescription:"",category:"",barcodeNumber:"",sellingPrice:0,costPrice:0,reorderLevel:0}),g=()=>{c("close")},b=()=>{c("submit",r.value)};return j(()=>a.product,l=>{l&&(r.value={itemName:l.itemName,itemDescription:l.itemDescription||"",category:l.category||"",barcodeNumber:l.barcodeNumber||"",sellingPrice:l.sellingPrice,costPrice:l.costPrice||0,reorderLevel:l.reorderLevel||0})},{immediate:!0}),(l,e)=>{const S=O;return i.isOpen?(p(),y("div",At,[t("div",Tt,[e[18]||(e[18]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Edit Product")],-1)),t("div",Bt,[i.error?(p(),y("div",qt,x(i.error),1)):h("",!0),t("div",Dt,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Product Name",-1)),v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>o(r).itemName=n),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm px-3 py-2 border",required:""},null,512),[[f,o(r).itemName]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Description",-1)),v(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=n=>o(r).itemDescription=n),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm px-3 py-2 border",rows:"3"},null,512),[[f,o(r).itemDescription]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Category",-1)),v(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>o(r).category=n),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm px-3 py-2 border"},null,512),[[f,o(r).category]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Barcode",-1)),v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>o(r).barcodeNumber=n),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm px-3 py-2 border"},null,512),[[f,o(r).barcodeNumber]])]),t("div",Vt,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Cost Price",-1)),v(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>o(r).costPrice=n),type:"number",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm px-3 py-2 border"},null,512),[[f,o(r).costPrice,void 0,{number:!0}]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Selling Price",-1)),v(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>o(r).sellingPrice=n),type:"number",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm px-3 py-2 border",required:""},null,512),[[f,o(r).sellingPrice,void 0,{number:!0}]])])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Reorder Level",-1)),v(t("input",{"onUpdate:modelValue":e[6]||(e[6]=n=>o(r).reorderLevel=n),type:"number",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm px-3 py-2 border"},null,512),[[f,o(r).reorderLevel,void 0,{number:!0}]])]),t("div",Ft,[t("p",It,[e[14]||(e[14]=N(" Current Stock: ",-1)),t("span",Ot,x(i.product?.currentStock),1)]),t("p",jt,[e[16]||(e[16]=N(" To update stock, ",-1)),w(S,{to:`/products/${i.product?.id}`,class:"text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-300 font-medium"},{default:z(()=>[...e[15]||(e[15]=[N(" click here ",-1)])]),_:1},8,["to"])])])])]),t("div",zt,[t("button",{onClick:g,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Cancel "),t("button",{onClick:b,disabled:i.isLoading,class:"px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[i.isLoading?(p(),y("span",Gt,[...e[17]||(e[17]=[t("svg",{class:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):h("",!0),N(" "+x(i.isLoading?"Saving...":"Save"),1)],8,Qt)])])])):h("",!0)}}},Rt={class:"bg-white dark:bg-gray-800 shadow"},Jt={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex justify-between items-center"},Kt={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},ee={__name:"index",setup(i){const{canManageProducts:m}=ut(),{$api:a}=at(),c=u([]),r=u(""),g=u(""),b=u(!1),l=u(1),e=u(10),S=u(!1),n=u(null),E=u(!1),$=u(""),U=u(!1),L=u(null),A=u(!1),P=u(""),M=C(()=>c.value.filter(s=>{const d=s.itemName.toLowerCase().includes(r.value.toLowerCase()),_=!g.value||s.category===g.value,B=!b.value||s.currentStock<=s.reorderLevel;return d&&_&&B})),Q=C(()=>Math.ceil(M.value.length/e.value)),D=C(()=>(l.value-1)*e.value),V=C(()=>Math.min(l.value*e.value,M.value.length)),G=C(()=>M.value.slice(D.value,V.value)),T=async()=>{try{const s=await a.get("/products");c.value=s.products||[]}catch(s){console.error("Error fetching products:",s)}},H=s=>{n.value=s,$.value="",S.value=!0},F=()=>{S.value=!1,n.value=null,$.value=""},R=async s=>{try{$.value="",E.value=!0,await a.put(`/products/${n.value.id}`,s),await T(),F()}catch(d){$.value=d.message||"Error updating product"}finally{E.value=!1}},J=s=>{L.value=s,P.value="",U.value=!0},I=()=>{U.value=!1,L.value=null,P.value=""},K=async s=>{try{P.value="",A.value=!0;const d=s.action==="add"?"IN":"OUT",_=s.quantity;await a.patch(`/products/${L.value.id}/update-stock`,{type:d,quantity:_,reason:s.reason||"ADJUSTMENT",notes:s.notes}),await T(),I()}catch(d){P.value=d.message||"Error updating stock"}finally{A.value=!1}},W=s=>{it(`/products/${s.id}`)};return j([r,g,b],()=>{l.value=1}),st(()=>{T()}),(s,d)=>{const _=O,B=bt,X=Ut,Y=nt,Z=Ht,tt=lt;return p(),y("div",null,[t("header",Rt,[t("div",Jt,[d[5]||(d[5]=t("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"Products",-1)),o(m)?(p(),dt(_,{key:0,to:"/products/add",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700"},{default:z(()=>[...d[4]||(d[4]=[N(" + Add Product ",-1)])]),_:1})):h("",!0)])]),t("main",Kt,[w(B,{search:o(r),"onUpdate:search":d[0]||(d[0]=k=>q(r)?r.value=k:null),category:o(g),"onUpdate:category":d[1]||(d[1]=k=>q(g)?g.value=k:null),lowStock:o(b),"onUpdate:lowStock":d[2]||(d[2]=k=>q(b)?b.value=k:null)},null,8,["search","category","lowStock"]),w(X,{products:o(G),"show-manage-actions":o(m),onEdit:H,onStock:J,onView:W},null,8,["products","show-manage-actions"]),w(Y,{"current-page":o(l),"total-pages":o(Q),"start-index":o(D),"end-index":o(V),"total-items":o(M).length,"onUpdate:page":d[3]||(d[3]=k=>l.value=k)},null,8,["current-page","total-pages","start-index","end-index","total-items"])]),w(Z,{"is-open":o(S),product:o(n),"is-loading":o(E),error:o($),onClose:F,onSubmit:R},null,8,["is-open","product","is-loading","error"]),w(tt,{"is-open":o(U),product:o(L),"is-loading":o(A),error:o(P),onClose:I,onSubmit:K},null,8,["is-open","product","is-loading","error"])])}}};export{ee as default};
